<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í´ë¼ì´ì–¸íŠ¸</title>
    <script
      src="https://cdn.socket.io/4.8.0/socket.io.min.js"
      integrity="sha384-OoIbkvzsFFQAG88r+IqMAjyOtYDPGO0cqK5HF5Uosdy/zUEGySeAzytENMDynREd"
      crossorigin="anonymous"
    ></script>

    <script>
      function addEmoji(emoji) {
        const message = document.getElementById("message");
        message.value += emoji;
      }
      const socket = io();

      function setNickname() {
        const nickname = document.getElementById("nickname").value;
        // ioê°ì²´.emit("ì´ë²¤íŠ¸ëª…", "ê°’")
        socket.emit("setNickname", nickname);
      }

      function sendMessage() {
        const message = document.getElementById("message").value;
        socket.emit("message", message);
      }

      function setChannel() {
        const channel = document.getElementById("channel").value;
        socket.emit("setChannel", channel);
      }

      // ìˆ˜ì‹  ì´ë²¤íŠ¸ ì²˜ë¦¬
      socket.on("setNickname", (message) => {
        const chatBoxElement = document.getElementById("chatBox");
        const newMessageElement = document.createElement("p");
        newMessageElement.textContent = message;
        chatBoxElement.appendChild(newMessageElement);
      });

      socket.on("message", (message) => {
        console.log(message);
        const chatBox = document.getElementById("chatBox");
        const newMessageElement = document.createElement("p");
        newMessageElement.textContent = `${message.sender}: ${message.message}`;
        chatBox.appendChild(newMessageElement);
        document.getElementById("message").value = "";
      });

      socket.on("updateChannelList", (channelList) => {
        const channelListElement = document.getElementById("channelList");
        channelListElement.innerHTML = "";
        channelList.forEach((channel) => {
          const channelItem = document.createElement("li");
          channelItem.textContent = channel;
          channelListElement.appendChild(channelItem);
        });
      });
    </script>
  </head>
  <body>
    <h2>ê°„ë‹¨í•œ ì±„íŒ…</h2>
    <form action="#">
      <p>
        ë‹‰ë„¤ì„: <input type="text" id="nickname" />
        <button type="button" onclick="setNickname()">ì„¤ì •</button>
      </p>
      <p>
        ì±„ë„: <input type="text" id="channel" />
        <button type="button" onclick="setChannel()">ì…ì¥</button>
      </p>
      <div>
        <ul id="channelList"></ul>
      </div>
      <p>
        <input type="text" id="message" />
        <button type="button" onclick="sendMessage()">ë³´ë‚´ê¸°</button>
        <button type="button" onclick="addEmoji('ğŸ˜')">ğŸ˜</button>
        <button type="button" onclick="addEmoji('ğŸƒ')">ğŸƒ</button>
        <button type="button" onclick="addEmoji('ğŸ˜‹')">ğŸ˜‹</button>
        <button type="button" onclick="addEmoji('ğŸ˜')">ğŸ˜</button>
        <button type="button" onclick="addEmoji('ğŸ˜‚')">ğŸ˜‚</button>
      </p>
    </form>
    <div id="chatBox"></div>
  </body>
</html>
